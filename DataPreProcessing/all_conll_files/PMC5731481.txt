Real-time O
motion O
analytics O
during O
brain O
MRI O
improve O
data O
quality O
and O
reduce O
costs O
Head O
motion O
systematically O
distorts O
clinical O
and O
research O
MRI O
data O
. O

Motion O
artifacts O
have O
biased O
findings O
from O
many O
structural O
and O
functional O
brain O
MRI O
studies O
. O

An O
effective O
way O
to O
remove O
motion O
artifacts O
is O
to O
exclude O
MRI O
data O
frames O
affected O
by O
head O
motion O
. O

However O
, O
such O
post-hoc O
frame O
censoring O
can O
lead O
to O
data O
loss O
rates O
of O
50 O
% O
or O
more O
in O
our O
pediatric O
patient O
cohorts O
. O

Hence O
, O
many O
scanner O
operators O
collect O
additional O
‘ O
buffer O
data O
’ O
, O
an O
expensive O
practice O
that O
, O
by O
itself O
, O
does O
not O
guarantee O
sufficient O
high-quality O
MRI O
data O
for O
a O
given O
participant O
. O

Therefore O
, O
we O
developed O
an O
easy-to-setup O
, O
easy-to-use O
Framewise O
Integrated O
Real-time O
MRI O
Monitoring O
( O
FIRMM O
) O
software O
suite O
that O
provides O
scanner O
operators O
with O
head O
motion O
analytics O
in O
real-time O
, O
allowing O
them O
to O
scan O
each O
subject O
until O
the O
desired O
amount O
of O
low-movement O
data O
has O
been O
collected O
. O

Our O
analyses O
show O
that O
using O
FIRMM O
to O
identify O
the O
ideal O
scan O
time O
for O
each O
person O
can O
reduce O
total O
brain O
MRI O
scan O
times O
and O
associated O
costs O
by O
50 O
% O
or O
more O
. O

2 O
. O

Materials O
and O
methods O
2.1 O
. O

FIRMM O
software O
suite O
FIRMM O
is O
built O
using O
several O
software O
packages O
, O
each O
with O
a O
specific O
purpose O
, O
to O
make O
installation O
and O
usage O
easier O
and O
more O
reliable O
. O

Installation O
requires O
a O
Docker-capable O
Linux O
system O
. O

Operation O
on O
Ubuntu O
14.04 O
and O
CentOS O
7 O
operating O
systems O
have O
both O
been O
tested O
and O
work O
well O
. O

Installation O
is O
accomplished O
via O
a O
downloadable O
shell O
script O
which O
retrieves O
and O
installs O
FIRMM O
’ O
s O
components O
. O

After O
installation O
FIRMM O
is O
launched O
with O
a O
shell O
script O
tailored O
to O
use O
a O
pre-built O
Docker O
image O
. O

FIRMM O
’ O
s O
components O
are O
the O
compiled O
MATLAB O
( O
R2016b O
) O
binary O
backend O
which O
only O
requires O
an O
included O
MATLAB O
compiler O
runtime O
to O
run O
, O
shell O
scripts O
for O
image O
processing O
, O
a O
Docker O
image O
containing O
image O
processing O
software O
dependencies O
, O
and O
a O
Django O
web O
application O
front O
end O
. O

The O
compiled O
MATLAB O
binary O
backend O
monitors O
an O
incoming O
folder O
waiting O
for O
a O
new O
subfolder O
that O
has O
the O
current O
date O
and O
contains O
images O
created O
within O
the O
last O
few O
minutes O
. O

The O
backend O
does O
shell O
script O
image O
processing O
only O
on O
new O
functional O
images O
. O

The O
required O
image O
processing O
software O
is O
already O
installed O
and O
configured O
inside O
the O
Docker O
image O
. O

Results O
are O
visually O
displayed O
in O
the O
Django O
web O
application O
frontend O
as O
plots O
and O
tables O
in O
a O
Chromium O
web O
browser O
. O

2.2 O
. O

Real-time O
processing O
of O
DICOM O
images O
As O
soon O
as O
each O
frame/volume O
of O
EPI O
( O
echo O
planar O
imaging O
) O
data O
is O
acquired O
and O
reconstructed O
into O
DICOM O
format O
, O
it O
is O
transferred O
to O
a O
pre-designated O
folder O
that O
the O
FIRMM O
software O
monitors O
for O
new O
images O
. O

On O
Siemens O
scanners O
, O
rapid O
DICOM O
transfer O
can O
be O
achieved O
by O
selecting O
the O
‘ O
send O
IMA O
’ O
option O
in O
the O
ideacmdtool O
utility O
( O
requires O
‘ O
advanced O
user O
’ O
mode O
) O
. O

On O
Siemens O
scanners O
one O
can O
also O
use O
an O
MS-DOS O
batch O
script O
to O
add O
start O
‘ O
FIRMM O
’ O
and O
stop O
‘ O
FIRMM O
’ O
buttons O
to O
the O
scanner O
operating O
system O
. O

This O
package O
is O
a O
standalone O
script O
that O
can O
be O
downloaded O
with O
FIRMM O
. O

FIRMM O
reads O
the O
DICOM O
headers O
and O
uses O
the O
header O
information O
to O
enter O
data O
sequentially O
into O
a O
job O
queuing O
system O
. O

DICOMs O
are O
processed O
in O
the O
temporal O
order O
they O
were O
acquired O
. O

FIRMM O
converts O
DICOMs O
into O
4dfp O
format O
prior O
to O
any O
further O
processing O
. O

FIRMM O
realigns O
EPI O
data O
using O
the O
4dfp O
cross_realign3d_4dfp O
algorithm O
. O

The O
cross_realign3d_4dfp O
algorithm O
run O
by O
FIRMM O
has O
been O
optimized O
for O
computational O
speed O
, O
thus O
frame-to-frame O
image O
intensity O
normalization O
has O
been O
disabled O
and O
the O
realigned O
data O
are O
not O
written O
out O
, O
only O
the O
alignment O
parameters O
. O

Alternative O
alignment O
algorithms O
operating O
on O
NIfTI O
format O
data O
can O
also O
be O
utilized O
and O
will O
be O
made O
available O
in O
future O
releases O
. O

The O
EPI O
images O
do O
not O
undergo O
pre-processing O
steps O
typically O
utilized O
in O
offline O
data O
analyses O
. O

For O
EPI O
images O
with O
a O
spatial O
resolution O
smaller O
than O
4 O
mm3 O
, O
data O
are O
down-sampled O
to O
4 O
mm3 O
prior O
to O
realignment O
to O
increase O
processing O
speed O
. O

2.3 O
. O

Estimation O
of O
head O
realignments O
Each O
data O
frame O
( O
volume O
) O
is O
aligned O
to O
the O
first O
frame O
of O
the O
run O
through O
a O
series O
of O
rigid O
body O
transforms O
, O
Ti O
, O
where O
i O
indexes O
the O
spatial O
registration O
of O
frame O
i O
to O
a O
reference O
of O
frame O
1 O
, O
starting O
with O
the O
second O
frame O
. O

Each O
transform O
is O
calculated O
by O
minimizing O
the O
registration O
error O
: O
such O
that O
I O
( O
x⃗ O
) O
is O
the O
image O
intensity O
at O
locus O
x⃗ O
and O
s O
is O
a O
scalar O
factor O
that O
compensates O
for O
fluctuations O
in O
mean O
signal O
intensity O
, O
spatially O
averaged O
over O
the O
whole O
brain O
( O
angle O
brackets O
) O
. O

Each O
transform O
is O
represented O
by O
a O
combination O
of O
rotations O
and O
displacements O
. O

Therefore O
, O
with O
Ri O
representing O
the O
3 O
× O
3 O
matrix O
of O
rotations O
and O
ḋi O
representing O
the O
3 O
× O
1 O
column O
vector O
of O
displacements O
. O

Ri O
consists O
of O
the O
three O
elementary O
rotations O
at O
each O
of O
the O
three O
axes O
. O

Hence O
, O
Ri O
= O
RiαRiβRiγ O
and O
2.4 O
. O

Computation O
of O
framewise O
displacement O
( O
FD O
) O
Calculating O
head O
realignment O
parameters O
across O
frames O
starting O
with O
the O
second O
frame O
generates O
six O
displacement O
vectors O
of O
head O
motion O
. O

We O
convert O
head O
motion O
to O
a O
scalar O
quantity O
with O
the O
formula O
, O
Displacementi O
= O
|Δdix| O
+ O
|Δdiy| O
+ O
|Δdiz| O
+ O
|Δαi| O
+ O
|Δβi| O
+ O
|Δγi| O
, O
where O
Δdix O
= O
d O
( O
i−1 O
) O
x O
− O
dix O
, O
Δdiy O
= O
d O
( O
i−1 O
) O
y O
− O
diy O
, O
Δdiz O
= O
d O
( O
i−1 O
) O
z O
− O
diz O
, O
and O
so O
forth O
. O

Rotational O
displacements O
are O
converted O
from O
degrees O
to O
millimeters O
by O
computing O
displacement O
on O
the O
surface O
of O
a O
sphere O
of O
radius O
50 O
mm O
, O
which O
is O
approximately O
the O
mean O
distance O
from O
the O
cerebral O
cortex O
to O
the O
center O
of O
the O
head O
for O
a O
healthy O
young O
adult O
. O

Since O
we O
realign O
each O
data O
frame O
to O
the O
first O
frame O
, O
FD O
is O
calculated O
by O
subtracting O
Displacementi−1 O
( O
for O
the O
previous O
frame O
) O
from O
Displacementi O
( O
for O
the O
current O
frame O
) O
. O

2.5 O
. O

Model O
for O
predicting O
framewise O
displacement O
( O
FD O
) O
The O
head O
motion O
( O
FD O
) O
prediction O
algorithm O
is O
a O
linear O
model O
that O
updates O
with O
each O
new O
data O
frame O
( O
y O
= O
mx O
+ O
b O
) O
, O
where O
y O
is O
the O
predicted O
number O
of O
low-movement O
frames O
below O
a O
certain O
FD O
cutoff O
at O
the O
end O
of O
the O
scan O
or O
experiment O
, O
x O
is O
the O
consecutive O
frame O
count O
, O
and O
m O
and O
b O
are O
estimated O
for O
each O
participant O
in O
real O
time O
. O

A O
given O
frame O
is O
labeled O
as O
usable O
if O
the O
relative O
object O
displacement O
is O
less O
than O
a O
given O
FD O
threshold O
( O
in O
mm O
) O
, O
using O
as O
reference O
the O
object O
’ O
s O
position O
in O
the O
previous O
frame O
. O

The O
prediction O
algorithm O
is O
implemented O
in O
Python O
using O
the O
scikit-learn O
package O
( O
http O
: O
//scikit-learn.org O
) O
. O

The O
prediction O
algorithm O
outputs O
are O
displayed O
inside O
the O
‘ O
Predicted O
Duration O
to O
Scan O
Criteria O
’ O
box O
in O
FIRMM O
’ O
s O
graphical O
user O
interface O
( O
GUI O
) O
, O
as O
minutes O
until O
the O
user-specified O
data O
criterion O
is O
reached O
. O

FIRMM O
users O
can O
select O
three O
FD O
thresholds O
( O
in O
mm O
) O
and O
the O
desired O
amount O
of O
low-movement O
data O
( O
in O
min O
. O
) O

using O
a O
simple O
settings O
file O
. O

2.6 O
. O

Visualization O
of O
framewise O
displacement O
( O
FD O
) O
in O
real O
time O
FIRMM O
uses O
a O
GUI O
designed O
with O
Django O
( O
https O
: O
//www.djangoproject.com/ O
) O
and O
Chart.js O
( O
http O
: O
//www.chartjs.org/ O
) O
to O
display O
FD O
traces O
and O
summary O
counts O
of O
data O
quality O
in O
real O
time O
. O

FIRMM O
continuously O
updates O
summary O
counts O
about O
the O
number O
of O
‘ O
high-quality O
’ O
low-movement O
frames O
already O
acquired O
( O
FD O
cutoff O
presets O
are O
0.2 O
mm O
, O
0.3 O
mm O
and O
0.4 O
mm O
) O
in O
table O
format O
and O
as O
a O
color-coded O
bar O
graph O
. O

At O
the O
end O
of O
each O
data O
acquisition O
epoch O
( O
run O
) O
the O
summary O
counts O
for O
that O
run O
are O
displayed O
in O
a O
list O
that O
tabulates O
the O
summary O
head O
motion O
data O
for O
each O
run O
separately O
and O
for O
the O
sum O
of O
all O
the O
data O
acquired O
thus O
far O
in O
the O
active O
scanning O
session O
. O

FIRMM O
also O
displays O
predictions O
about O
how O
much O
longer O
a O
given O
subject O
will O
likely O
have O
to O
be O
scanned O
until O
the O
preset O
time-to-criterion O
( O
minutes O
of O
low-movement O
FD O
data O
) O
has O
been O
acquired O
. O

There O
is O
also O
a O
graph O
of O
the O
actual O
amount O
of O
time O
( O
in O
min O
and O
s O
) O
one O
has O
scanned O
‘ O
low-movement O
’ O
frames O
toward O
a O
preset O
criterion O
amount O
of O
time O
. O

Users O
are O
able O
to O
customize O
the O
FD O
cutoffs O
and O
data O
amount O
criterion O
by O
opening O
FIRMM O
in O
the O
settings O
mode O
( O
FIRMM O
-s O
) O
. O

FIRMM O
can O
be O
run O
in O
the O
help O
mode O
by O
typing O
FIRMM O
-h. O
2.7 O
. O

FIRMM O
monitoring O
: O
scanner O
requirements O
FIRMM O
requires O
an O
MRI O
scanner O
enabled O
to O
rapidly O
reconstruct O
and O
transfer O
BOLD O
images O
. O

FIRMM O
currently O
expects O
an O
EPI O
mosaic O
as O
provided O
by O
Siemens O
, O
but O
is O
customizable O
to O
work O
with O
non-mosaic O
formats O
( O
i.e O
. O

GE O
and O
Philips O
) O
. O

FIRMM O
monitoring O
was O
developed O
and O
tested O
on O
Siemens O
3T O
Tim O
Trio O
and O
Siemens O
3T O
Prisma O
scanners O
at O
Washington O
University O
School O
of O
Medicine O
( O
WUSM O
) O
and O
Oregon O
Health O
& O
Science O
University O
( O
OHSU O
) O
. O

Additional O
beta O
testing O
has O
been O
conducted O
as O
part O
of O
the O
Adolescent O
Brain O
Cognitive O
Development O
( O
ABCD O
) O
project O
at O
several O
MRI O
sites O
and O
is O
now O
being O
implemented O
as O
a O
core O
advancement O
for O
this O
national O
study O
of O
10,000 O
children O
who O
will O
be O
scanned O
biannually O
over O
the O
next O
10 O
years O
( O
http O
: O
//www.ABCDstudy.org O
) O
. O

FIRMM O
was O
expressly O
designed O
to O
also O
be O
compatible O
with O
General O
Electric O
( O
GE O
) O
and O
Philips O
MRI O
scanners O
and O
dedicated O
GE O
and O
Philips O
versions O
are O
under O
development O
. O

On O
Siemens O
scanners O
FIRMM O
monitoring O
can O
utilize O
the O
ideacmdtool O
SendIMA O
option O
with O
buffering O
disabled O
. O

Alternatively O
, O
rapid O
DICOM O
forwarding O
can O
also O
be O
built O
directly O
into O
Siemens O
sequences O
, O
or O
an O
MS-DOS O
batch O
can O
be O
used O
to O
insert O
FIRMM O
‘ O
start O
’ O
and O
‘ O
stop O
’ O
buttons O
into O
the O
operating O
system O
( O
stand-alone O
software O
that O
can O
be O
downloaded O
with O
FIRMM O
) O
. O

2.8 O
. O

FIRMM O
works O
with O
a O
wide O
range O
of O
sequences O
and O
EPI O
image O
types O
Today O
’ O
s O
MRI O
data O
acquisition O
landscape O
is O
changing O
rapidly O
. O

With O
multiband O
imaging O
, O
EPI O
data O
for O
sequences O
such O
as O
BOLD O
can O
now O
be O
collected O
every O
few O
hundred O
milliseconds O
and O
at O
spatial O
resolutions O
as O
low O
as O
2 O
mm O
isotropic O
. O

While O
our O
estimations O
of O
FIRMM-driven O
time O
savings O
and O
the O
initial O
live O
testing O
of O
FIRMM O
were O
conducted O
on O
single-band O
EPI O
data O
with O
TRs O
of O
2.0–2.5 O
s O
, O
we O
have O
since O
verified O
that O
FIRMM O
works O
equally O
well O
with O
multiband O
EPI O
data O
acquired O
at O
spatial O
resolutions O
as O
low O
as O
2 O
mm O
isotropic O
and O
with O
TRs O
as O
short O
as O
700 O
ms. O
For O
BOLD O
data O
with O
high O
multiband O
factors O
, O
small O
voxel O
sizes O
and O
short O
TRs O
, O
the O
rate-limiting O
step O
is O
image O
reconstruction O
from O
k-space O
data O
, O
not O
FIRMM O
’ O
s O
FD O
calculations O
and O
predictions O
. O

While O
image O
reconstruction O
can O
take O
longer O
for O
these O
types O
of O
acquisition O
parameters O
, O
vendor O
software O
platforms O
are O
becoming O
faster O
. O

Siemens O
image O
reconstruction O
as O
implemented O
in O
VE11B O
and O
VE11C O
is O
fast O
enough O
for O
FIRMM O
FD O
calculations O
to O
keep O
up O
with O
the O
speed O
of O
data O
acquisition O
at O
TRs O
of O
700 O
ms O
. O

In O
addition O
, O
we O
simulated O
even O
faster O
image O
acquisition O
rates O
( O
TRs O
down O
to O
500 O
ms O
) O
and O
FIRMM O
was O
still O
able O
to O
keep O
up O
and O
deliver O
accurate O
real-time O
FD O
calculations O
. O

In O
addition O
to O
providing O
real-time O
head O
motion O
information O
during O
EPI O
imaging O
( O
rs-fcMRI O
, O
fMRI O
) O
at O
various O
resolutions O
and O
TRs O
, O
FIRMM O
can O
also O
be O
used O
to O
calculate O
FD O
on O
the O
EPI O
motion O
marker O
or O
navigator O
images O
collected O
as O
part O
of O
novel O
motion-correcting O
structural O
sequences O
. O

Such O
navigator O
images O
are O
similar O
enough O
to O
other O
EPI O
images O
that O
FIRMM O
can O
monitor O
head O
motion O
as O
long O
as O
it O
receives O
the O
EPI O
navigator O
images O
in O
real O
time O
. O

This O
use O
case O
is O
planned O
for O
development O
in O
a O
later O
release O
. O

2.9 O
. O

FIRMM O
computer O
requirements O
The O
only O
hardware O
requirement O
for O
running O
FIRMM O
is O
a O
Docker-capable O
Linux O
computer O
networked O
to O
the O
computer O
running O
the O
scanner O
operating O
system O
, O
which O
is O
already O
part O
of O
the O
typical O
setup O
for O
MRI O
scanners O
used O
in O
research O
. O

The O
FIRMM O
software O
is O
self-contained O
in O
a O
Docker O
image O
and O
does O
not O
require O
licenses O
or O
the O
installation O
of O
other O
software O
packages O
. O

FIRMM O
has O
been O
most O
extensively O
used O
with O
a O
self-built O
computer O
running O
Linux O
( O
Ubuntu O
14.04 O
LTS O
) O
and O
the O
following O
hardware O
specifications O
: O
Intel O
Core O
i7 O
4790 O
K O
4.0 O
GHz O
processor O
, O
16 O
GB O
DDR3 O
memory O
, O
Samsung O
850 O
EVO O
120 O
GB O
SSD O
and O
NVIDIA O
GTX O
960 O
GPU O
. O

2.10 O
. O

FIRMM O
code O
availability O
We O
are O
making O
the O
FIRMM O
software O
and O
manuals O
available O
on O
our O
website O
( O
http O
: O
//www.firmm.us O
) O
and O
on O
the O
Neuroimaging O
Informatics O
Tools O
and O
Resources O
Clearinghouse O
( O
https O
: O
//www.nitrc.org O
) O
. O

Installation O
instructions O
for O
FIRMM O
can O
be O
found O
at O
: O
http O
: O
//www.firmm.us O
. O

Detailed O
documentation O
is O
included O
with O
the O
software O
download O
. O

2.11 O
. O

Using O
FIRMM O
We O
focused O
on O
making O
FIRMM O
as O
easy O
to O
launch O
as O
possible O
to O
minimize O
the O
time O
interval O
between O
subject O
arrival O
and O
starting O
the O
first O
run O
, O
which O
can O
reduce O
costs O
and O
increase O
the O
chance O
of O
getting O
through O
the O
entire O
protocol O
for O
longer O
scanning O
sessions O
, O
especially O
in O
special O
populations O
. O

In O
its O
current O
version O
, O
scanner O
operators O
open O
the O
FIRMM O
monitoring O
GUI O
by O
typing O
‘ O
FIRMM O
’ O
into O
the O
command O
line O
. O

To O
start O
monitoring O
head O
movement O
in O
real O
time O
the O
scanner O
operator O
must O
open O
FIRMM O
and O
then O
click O
the O
‘ O
Start O
FIRMM O
’ O
button O
which O
will O
begin O
monitoring O
the O
backend O
JSON O
file O
for O
updates O
. O

Once O
launched O
, O
FIRMM O
requires O
no O
additional O
inputs O
because O
it O
automatically O
detects O
the O
active O
MRI O
scanning O
session O
folder O
and O
monitors O
for O
new O
incoming O
EPI O
acquisitions O
, O
separating O
images O
into O
distinct O
runs O
. O

Should O
the O
scanner O
operator O
forget O
to O
launch O
FIRMM O
at O
the O
beginning O
of O
the O
scanning O
session O
, O
he O
or O
she O
can O
launch O
FIRMM O
at O
any O
point O
during O
the O
study O
and O
FIRMM O
will O
process O
all O
EPI O
images O
associated O
with O
the O
current O
session O
in O
the O
correct O
order O
until O
it O
catches O
up O
to O
ongoing O
image O
acquisition O
. O

FIRMM O
automatically O
saves O
a O
log O
file O
for O
each O
run O
during O
a O
scanning O
session O
. O

Shutting O
down O
FIRMM O
only O
requires O
closing O
the O
FIRMM O
GUI O
window O
. O

All O
synced O
dicoms O
are O
automatically O
deleted O
from O
the O
host O
computer O
after O
48 O
h. O
2.12 O
. O

FIRMM O
outputs O
FIRMM O
saves O
a O
temporary O
processing O
folder O
per O
study O
using O
the O
DICOM O
header O
information O
. O

In O
that O
folder O
, O
FIRMM O
saves O
the O
head O
motion O
parameters O
and O
FD O
values O
associated O
with O
each O
data O
frame O
. O

FIRMM O
also O
generates O
and O
saves O
a O
JSON O
file O
of O
the O
full O
information O
displayed O
in O
the O
GUI O
at O
the O
conclusion O
of O
the O
scanning O
session O
. O

By O
loading O
the O
JSONs O
of O
completed O
scans O
, O
users O
are O
able O
to O
recreate O
the O
final O
FIRMM O
display O
of O
previous O
scan O
session O
. O

For O
each O
scanning O
session O
FIRMM O
also O
writes O
out O
a O
simple O
text O
log O
( O
.csv O
) O
containing O
each O
data O
frame O
’ O
s O
FD O
value O
and O
the O
six O
underlying O
motion O
parameters O
. O

FIRMM O
users O
interested O
in O
using O
FIRMM O
’ O
s O
motion O
numbers O
for O
data O
processing O
and O
denoising O
can O
either O
import O
them O
from O
the O
log O
files O
, O
or O
from O
the O
JSON O
files O
using O
the O
JQ O
command-line O
JSON O
processor O
( O
https O
: O
//stedolan.github.io/jq/ O
) O
. O

2.13 O
. O

Future O
upgrades O
to O
FIRMM O
As O
noted O
above O
, O
the O
current O
version O
of O
FIRMM O
is O
part O
of O
the O
standard O
acquisition O
protocol O
for O
the O
21-site O
ABCD O
study O
that O
will O
collect O
MRI O
data O
( O
structural O
, O
task O
fMRI O
, O
and O
rs-fcMRI O
) O
from O
10,000 O
children O
biannually O
over O
the O
span O
of O
10 O
years O
, O
starting O
at O
the O
age O
of O
9 O
. O

We O
expect O
the O
ABCD O
study O
to O
provide O
a O
great O
deal O
of O
valuable O
feedback O
to O
further O
improve O
FIRMM O
’ O
s O
utility O
. O

ABCD O
functional O
( O
fMRI O
, O
rs-fcMRI O
) O
and O
structural O
( O
motion-correcting O
T1 O
, O
motion-correcting O
T2 O
) O
data O
should O
allow O
us O
to O
further O
improve O
the O
accuracy O
of O
our O
head O
motion O
prediction O
algorithm O
in O
the O
age O
range O
under O
investigation O
. O

FIRMM O
upgrades O
already O
under O
development O
are O
aimed O
at O
making O
it O
even O
easier O
to O
use O
and O
to O
broaden O
its O
capabilities O
. O

Hence O
, O
we O
are O
currently O
testing O
a O
version O
of O
FIRMM O
with O
interactive O
graphics O
that O
would O
further O
simplify O
its O
use O
by O
allowing O
the O
selection O
and O
deselection O
of O
specific O
individual O
scans O
for O
inclusion O
in O
the O
actual O
and O
predicted O
amount O
of O
low-movement O
data O
. O

Planned O
future O
versions O
of O
FIRMM O
should O
also O
allow O
users O
to O
display O
DVAR O
( O
D O
for O
derivative O
of O
timeseries O
, O
VAR O
for O
RMS O
variance O
across O
voxels O
) O
as O
an O
additional O
EPI O
data O
quality O
metric O
. O

DVAR O
measures O
how O
much O
the O
whole O
brain O
signal O
intensity O
varies O
from O
each O
data O
frame O
to O
the O
next O
, O
independent O
of O
the O
source O
of O
signal O
change O
. O

DVAR O
traces O
are O
very O
sensitive O
to O
frame-to-frame O
head O
motion O
but O
in O
principle O
can O
also O
detect O
EPI O
signal O
aberrancies O
from O
sources O
other O
than O
head O
motion O
. O

In O
addition O
to O
the O
4dfp O
alignment O
algorithm O
currently O
implemented O
by O
FIRMM O
, O
future O
versions O
will O
allow O
scanner O
operators O
to O
choose O
between O
similar O
, O
but O
slightly O
different O
, O
EPI O
image O
registration O
methods O
for O
calculating O
FD O
( O
FSL O
, O
AFNI O
, O
SPM O
) O
. O

Options O
for O
feeding O
information O
about O
head O
motion O
back O
to O
the O
subject O
, O
post-run O
and/or O
in O
real O
time O
are O
undergoing O
testing O
. O

Those O
feedback O
approaches O
most O
effective O
at O
reducing O
head O
motion O
will O
also O
be O
built O
into O
future O
versions O
of O
FIRMM O
. O

2.14 O
. O

Validation O
data O
sets O
For O
this O
study O
, O
extant O
rs-fcMRI O
data O
( O
Table O
1 O
) O
from O
a O
total O
of O
1134 O
scanning O
sessions O
of O
children O
, O
teens O
, O
and O
young O
adults O
( O
447 O
female O
scans O
) O
with O
a O
mean O
age O
of O
12.4 O
years O
( O
range O
= O
7.2–19.6 O
years O
) O
, O
were O
utilized O
to O
compare O
FIRMM O
’ O
s O
FD O
calculations O
to O
standard O
offline O
methods O
( O
WashU O
4dfp O
) O
and O
to O
estimate O
the O
scanning O
cost O
reductions O
had O
FIRMM O
been O
available O
at O
the O
time O
of O
scanning O
. O

These O
data O
came O
from O
two O
different O
data O
sets O
that O
were O
pooled O
for O
the O
purpose O
of O
this O
study O
. O

The O
same O
data O
were O
also O
used O
to O
validate O
FIRMM O
’ O
s O
head O
motion O
prediction O
algorithm O
. O

These O
data O
included O
cohorts O
with O
attention O
deficit O
hyperactivity O
disorder O
( O
ADHD O
: O
425 O
scanning O
sessions O
, O
140 O
female O
) O
, O
autism O
spectrum O
disorder O
( O
ASD O
: O
84 O
scanning O
sessions O
, O
17 O
female O
) O
, O
a O
family O
history O
of O
alcoholism O
( O
FHA O
: O
304 O
scanning O
sessions O
, O
141 O
female O
) O
and O
age-matched O
neurotypical O
controls O
( O
Controls O
: O
321 O
scanning O
sessions O
, O
149 O
female O
) O
. O

The O
Human O
Investigation O
Review O
Board O
at O
OHSU O
( O
datasets O
1 O
, O
2 O
) O
approved O
the O
research O
. O

Written O
informed O
consent O
was O
obtained O
from O
respective O
parents O
and O
verbal O
or O
written O
assent O
was O
obtained O
from O
child O
participants O
. O

2.14.1 O
. O

ADHD O
, O
ASD O
, O
neurotypical O
controls O
( O
dataset O
1 O
) O
The O
ADHD O
and O
ASD O
cohorts O
, O
alongside O
age-matched O
neurotypical O
controls O
, O
were O
recruited O
as O
part O
of O
two O
ongoing O
longitudinal O
studies O
in O
the O
Fair O
and O
Nigg O
laboratories O
. O

For O
neurotypical O
and O
ADHD O
participants O
, O
children O
were O
recruited O
from O
families O
who O
volunteered O
in O
response O
to O
mass O
mailings O
in O
the O
community O
. O

Their O
diagnostic O
grouping O
was O
carefully O
evaluated O
in O
best-estimate O
, O
multi-stage O
case O
finding O
procedure O
. O

Children O
were O
excluded O
if O
they O
did O
not O
meet O
criteria O
for O
ADHD O
or O
non-ADHD O
groups O
. O

Exclusion O
criteria O
were O
tic O
disorder O
, O
psychotic O
disorder O
, O
bipolar O
disorder O
, O
autism O
spectrum O
disorder O
, O
conduct O
disorder O
, O
major O
depressive O
disorder O
, O
intellectual O
disability O
, O
neurological O
illness O
, O
chronic O
medical O
problems O
, O
sensorimotor O
disability O
, O
significant O
head O
trauma O
( O
with O
loss O
of O
consciousness O
) O
; O
or O
if O
they O
were O
taking O
psychotropic O
medications O
other O
than O
psychostimulants O
. O

Children O
were O
also O
excluded O
if O
they O
had O
contra-indications O
to O
MRI O
. O

Only O
right-handed O
children O
were O
included O
in O
the O
study O
. O

Children O
prescribed O
psychostimulant O
medications O
were O
scanned O
after O
a O
minimum O
washout O
period O
of O
five O
half-lives O
( O
i.e O
. O

24–48 O
h O
depending O
on O
the O
preparation O
) O
. O

For O
ASD O
participants O
, O
diagnosis O
was O
determined O
by O
a O
multi-disciplinary O
clinical O
team O
that O
utilized O
the O
ADOS O
. O

All O
children O
also O
met O
ASD O
criteria O
on O
the O
ADI-R O
, O
using O
DSM-IV O
criteria O
. O

Children O
with O
ASD O
were O
also O
assessed O
for O
ADHD O
by O
the O
same O
research O
methods O
noted O
above O
. O

As O
above O
, O
children O
with O
ASD O
who O
were O
taking O
psychostimulant O
medications O
were O
allowed O
in O
but O
were O
washed O
out O
for O
a O
minimum O
of O
24–48 O
h O
( O
depending O
on O
formulation O
) O
or O
at O
least O
7 O
half-lives O
of O
the O
formulation O
( O
i.e O
. O

the O
period O
of O
time O
it O
takes O
the O
body O
to O
metabolize/excrete O
half O
of O
the O
dose O
of O
the O
medication O
) O
prior O
to O
neuroimaging O
. O

Children O
taking O
non-stimulant O
psychoactive O
medications O
( O
e.g O
. O

tricyclic O
antidepressants O
, O
SSRIs O
, O
MAO O
inhibitors O
, O
or O
antipsychotic O
medication O
and O
atomoxetine O
) O
were O
excluded O
from O
the O
study O
. O

2.14.2 O
. O

Family O
history O
of O
alcoholism O
, O
neurotypical O
controls O
( O
dataset O
2 O
) O
Participants O
, O
ages O
10–16 O
years O
, O
were O
recruited O
from O
the O
local O
community O
. O

Family O
history O
of O
alcoholism O
( O
FHA O
) O
positive O
youth O
were O
part O
of O
an O
ongoing O
longitudinal O
study O
in O
the O
Nagel O
laboratory O
and O
matched O
for O
demographic O
characteristics O
to O
family O
history O
negative O
participants O
( O
neurotypical O
controls O
) O
. O

To O
determine O
eligibility O
, O
structured O
interviews O
were O
conducted O
by O
telephone O
with O
the O
youth O
and O
one O
of O
their O
parents O
[ O
Structured O
Clinical O
Interview O
; O
] O
. O

Exclusionary O
criteria O
included O
: O
lack O
of O
information O
on O
family O
history O
, O
family O
history O
of O
psychotic O
disorders O
( O
i.e O
. O

schizophrenia O
or O
bipolar O
I O
) O
, O
diagnosis O
of O
a O
DSM-IV O
psychiatric O
disorder O
[ O
Diagnostic O
Interview O
Schedule O
for O
Children O
, O
Predictive O
Scales O
] O
, O
significant O
lifetime O
alcohol O
or O
substance O
use O
( O
> O
10 O
lifetime O
alcoholic O
drinks O
or O
> O
2 O
drinks O
on O
any O
single O
occasion O
, O
> O
5 O
uses O
of O
marijuana O
, O
> O
4 O
cigarettes O
per O
day O
, O
any O
other O
drug O
use O
) O
[ O
Customary O
Drinking O
and O
Drug O
Use O
Record O
; O
] O
, O
neurological O
illness O
, O
significant O
head O
trauma O
( O
loss O
of O
consciousness O
> O
2 O
min O
) O
, O
serious O
medical O
conditions O
, O
intellectual O
disability O
or O
learning O
disability O
, O
prenatal O
exposure O
to O
drugs O
or O
alcohol O
, O
left-handedness O
[ O
Edinburgh O
Handedness O
Inventory O
; O
] O
, O
premature O
birth O
( O
< O
36 O
weeks O
) O
, O
MRI O
contraindications O
, O
and O
pregnancy O
or O
possible O
pregnancy O
. O

2.15 O
. O

FIRMM O
usage O
testing O
After O
applying O
FIRMM O
to O
the O
1134 O
extant O
scans O
( O
data O
sets O
1 O
, O
2 O
) O
, O
we O
tested O
FIRMM O
’ O
s O
utility O
for O
scanner O
operators O
in O
a O
new O
cohort O
of O
29 O
children O
( O
FIRMM O
testing O
dataset O
3 O
: O
11 O
female O
, O
mean O
age O
= O
11.5 O
years O
, O
age O
range O
= O
5.9–15.9 O
years O
) O
. O

The O
Washington O
University O
( O
WU O
) O
Human O
Research O
Protection O
Office O
approved O
the O
research O
. O

Written O
informed O
consent O
was O
obtained O
from O
respective O
parents O
and O
verbal O
or O
written O
assent O
was O
obtained O
from O
child O
participants O
. O

A O
total O
of O
29 O
children O
between O
the O
ages O
of O
5–16 O
years O
old O
were O
recruited O
from O
the O
local O
community O
and O
underwent O
rs-fcMRI O
scanning O
for O
a O
study O
that O
provided O
access O
to O
FIRMM O
to O
the O
scanner O
operators O
( O
Table O
2 O
) O
. O

Children O
were O
excluded O
for O
any O
contraindications O
to O
MRI O
. O

Being O
left-handed O
was O
not O
an O
exclusion O
criterion O
. O

All O
participants O
were O
native O
English O
speakers O
. O

2.16 O
. O

Validation O
and O
FIRMM O
usage O
testing O
data O
acquisition O
parameters O
Dataset O
1 O
and O
2 O
participants O
were O
scanned O
on O
a O
Siemens O
Tim O
Trio O
3.0 O
T O
Magnetom O
Tim O
Trio O
system O
( O
Siemens O
Medical O
Solutions O
, O
Erlangen O
, O
Germany O
) O
with O
a O
12-channel O
head O
coil O
, O
located O
at O
OHSU O
’ O
s O
Advanced O
Imaging O
Research O
Center O
. O

A O
high-resolution O
T1-weighted O
MPRAGE O
sequence O
was O
acquired O
( O
resolution O
= O
1 O
× O
1 O
× O
1.1 O
mm O
) O
. O

BOLD-weighted O
functional O
images O
were O
collected O
( O
along O
the O
anterior–posterior O
commissure O
) O
using O
T2 O
* O
-weighted O
echo O
planar O
imaging O
( O
TR O
= O
2500 O
ms O
, O
TE O
= O
30 O
ms O
, O
flip O
angle O
= O
90° O
, O
FOV O
= O
240 O
mm2 O
, O
36 O
slices O
covering O
the O
entire O
brain O
, O
slice O
thickness O
= O
3.8 O
mm O
, O
resolution O
= O
3.75 O
× O
3.75 O
× O
3.8 O
mm O
) O
. O

Three O
runs O
of O
5 O
min O
of O
resting O
state O
BOLD O
data O
were O
acquired O
, O
during O
which O
participants O
were O
instructed O
to O
stay O
still O
and O
fixate O
on O
a O
white O
crosshair O
in O
the O
center O
of O
a O
black O
screen O
projected O
from O
the O
head O
of O
the O
scanner O
and O
viewed O
with O
a O
mirror O
mounted O
on O
a O
12-channel O
head O
coil O
. O

Dataset O
3 O
participants O
were O
scanned O
on O
a O
Siemens O
Tim O
Trio O
3.0 O
T O
Magnetom O
system O
( O
Siemens O
Medical O
Solutions O
, O
Erlangen O
, O
Germany O
) O
with O
a O
12-channel O
head O
coil O
, O
located O
at O
WU O
’ O
s O
East O
Building O
Imaging O
Center O
. O

A O
high-resolution O
T1-weighted O
MPRAGE O
sequence O
was O
acquired O
( O
resolution O
= O
1 O
× O
1 O
× O
1 O
mm O
) O
. O

Functional O
images O
were O
acquired O
using O
a O
BOLD O
contrast-sensitive O
echoplanar O
sequence O
( O
TE O
= O
27 O
ms O
, O
flip O
angle O
= O
90° O
, O
in-plane O
resolution O
4 O
× O
4 O
mm O
; O
volume O
TR O
= O
2.5 O
s O
) O
. O

Whole-brain O
coverage O
was O
obtained O
with O
32 O
contiguous O
interleaved O
4 O
mm O
axial O
slices O
. O

Participants O
completed O
up O
to O
seven O
6.8 O
min O
BOLD O
runs O
. O

During O
two O
of O
seven O
runs O
participants O
were O
in O
the O
resting O
state O
, O
which O
consisted O
of O
viewing O
a O
centrally O
presented O
white O
crosshair O
( O
subtending O
< O
1° O
visual O
angle O
) O
on O
a O
black O
background O
. O

During O
the O
other O
five O
runs O
participants O
watched O
brief O
movies O
and/or O
received O
visual O
feedback O
about O
their O
head O
motion O
. O

2.17 O
. O

Analyses O
comparing O
FIRMM O
and O
offline O
FD O
values O
For O
all O
1134 O
scan O
sessions O
FD O
values O
were O
calculated O
using O
FIRMM O
( O
see O
sections O
2.2 O
, O
2.3 O
, O
2.4 O
) O
as O
well O
as O
using O
a O
previously O
published O
Offline O
method O
. O

The O
differences O
between O
the O
FIRMM O
and O
Offline O
FD O
values O
are O
1 O
) O
that O
the O
FIRMM O
FD O
values O
are O
calculated O
on O
the O
‘ O
raw O
’ O
BOLD O
images O
, O
prior O
to O
de-banding O
and O
slice-time-correction O
, O
and O
2 O
) O
that O
the O
FIRMM O
FD O
values O
are O
computed O
from O
BOLD O
image O
alignments O
relative O
to O
the O
first O
data O
frame O
instead O
of O
the O
run O
’ O
s O
middle O
frame O
( O
Offline O
) O
. O

All O
other O
steps O
such O
as O
the O
estimation O
of O
head O
realignment O
( O
section O
2.3 O
) O
and O
the O
formula O
for O
calculating O
FD O
( O
section O
2.4 O
) O
are O
the O
same O
for O
the O
FIRMM O
and O
Offline O
methods O
. O

For O
both O
FD O
calculation O
methods O
( O
FIRMM O
, O
Offline O
) O
the O
number O
of O
usable O
low O
movement O
frames O
were O
calculated O
for O
three O
commonly O
used O
stringent O
thresholds O
( O
FD O
< O
0.2 O
mm O
, O
FD O
< O
0.3 O
mm O
, O
FD O
< O
0.4 O
mm O
) O
. O

For O
the O
whole O
sample O
of O
1134 O
scans O
the O
correlation O
in O
the O
percentage O
of O
usable O
low O
movement O
frames O
between O
FIRMM O
and O
Offline O
was O
calculated O
for O
each O
frame O
censoring O
threshold O
( O
Fig O
. O

3 O
, O
Supplementary O
Fig O
. O

2 O
. O

2.18 O
. O

Analyses O
estimating O
time O
savings O
generated O
by O
FIRMM O
To O
estimate O
how O
much O
scan O
time O
could O
have O
been O
saved O
by O
using O
FIRMM O
to O
scan O
until O
each O
subject O
had O
acquired O
the O
desired O
number O
of O
frames O
below O
the O
FD O
cutoff O
( O
scanning-to-criterion O
) O
, O
we O
generated O
low O
movement O
data O
( O
FD O
< O
0.2 O
mm O
) O
accumulation O
plots O
for O
all O
1134 O
scan O
session O
. O

These O
plots O
show O
the O
accumulation O
of O
low O
movement O
data O
( O
min. O
, O
y-axis O
) O
relative O
to O
the O
time O
spent O
scanning O
( O
min O
. O

; O
x-axis O
) O
( O
Fig O
. O

5a O
) O
. O

We O
then O
generated O
low O
movement O
data O
accumulation O
plots O
for O
each O
of O
our O
cohorts O
( O
ASD O
, O
ADHD O
, O
FHA O
, O
Control O
) O
( O
Fig O
. O

5b O
) O
. O

In O
these O
plots O
the O
area O
under O
the O
curve O
represents O
the O
relative O
scan O
time O
savings O
( O
percent O
) O
when O
scanning-to-criterion O
instead O
of O
scanning O
all O
participants O
for O
20 O
min O
. O

For O
those O
scan O
sessions O
with O
< O
20 O
min O
of O
collected O
data O
, O
we O
linearly O
extrapolated O
the O
accumulation O
of O
usable O
frames O
from O
the O
existing O
data O
( O
Fig O
. O

5b O
) O
. O

We O
also O
used O
the O
1134 O
individual O
low O
movement O
data O
accumulation O
plots O
to O
calculate O
the O
time O
difference O
in O
time-to-criterion O
between O
the O
FIRMM O
and O
Offline O
methods O
( O
Supplementary O
Fig O
. O

4 O
) O
. O

